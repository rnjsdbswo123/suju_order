{% extends 'base.html' %}

{% block content %}
<div class="container mt-4" style="max-width: 800px;">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold">📤 데이터 일괄 업로드</h3>
        <a href="/api/production/status/" class="btn btn-outline-dark btn-sm">🏠 메인으로</a>
    </div>

    {% if messages %}
    <div class="alert alert-success shadow-sm">
        {% for message in messages %}{{ message }}{% endfor %}
    </div>
    {% endif %}

    <div class="alert alert-warning d-flex align-items-center mb-4" role="alert">
        <div class="fs-4 me-3">⚠️</div>
        <div>
            <strong>주의사항:</strong> 모든 엑셀 파일의 <strong>첫 번째 줄(1행)은 제목으로 간주하여 건너뜁니다.</strong><br>
            실제 데이터는 <strong>2번째 줄</strong>부터 입력해 주세요.
        </div>
    </div>

    <div class="row g-4">
        
        <div class="col-md-12">
            <div class="card shadow-sm border-primary border-opacity-25">
                <div class="card-header bg-primary text-white fw-bold d-flex justify-content-between">
                    <span>1. 거래처 등록 (Customer)</span>
                    <small>Step 1</small>
                </div>
                <div class="card-body">
                    <h6 class="fw-bold text-primary mb-2">📊 엑셀 작성 양식</h6>
                    <table class="table table-bordered table-sm text-center small mb-3">
                        <thead class="table-light">
                            <tr>
                                <th style="width: 50%;">A열 (필수)</th>
                                <th style="width: 50%;">B열 (선택)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="fw-bold">
                                <td>거래처명</td>
                                <td>사업자번호</td>
                            </tr>
                            <tr class="text-muted">
                                <td>(예) 김밥천국 본점</td>
                                <td>123-45-67890</td>
                            </tr>
                        </tbody>
                    </table>

                    <form method="post" enctype="multipart/form-data" class="input-group">
                        {% csrf_token %}
                        <input type="file" name="customer_file" class="form-control" required accept=".xlsx, .xls">
                        <button class="btn btn-primary" type="submit">거래처 업로드</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-12">
            <div class="card shadow-sm border-success border-opacity-25">
                <div class="card-header bg-success text-white fw-bold d-flex justify-content-between">
                    <span>2. 품목 등록 (Product)</span>
                    <small>Step 2</small>
                </div>
                <div class="card-body">
                    <h6 class="fw-bold text-success mb-2">📊 엑셀 작성 양식</h6>
                    <table class="table table-bordered table-sm text-center small mb-3">
                        <thead class="table-light">
                            <tr>
                                <th style="width: 30%;">A열 (선택)</th>
                                <th style="width: 30%;">B열 (필수/고유)</th>
                                <th style="width: 20%;">C열 (숫자)</th>
                                <th style="width: 20%;">D열 (선택)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="fw-bold">
                                <td>품목명</td>
                                <td>SKU (품목코드)</td>
                                <td>단가</td>
                                <td>생산동</td>
                            </tr>
                            <tr class="text-muted">
                                <td>(예) 계란 30구</td>
                                <td>EG-30-001</td>
                                <td>5000</td>
                                <td>A동</td>
                            </tr>
                        </tbody>
                    </table>

                    <form method="post" enctype="multipart/form-data" class="input-group">
                        {% csrf_token %}
                        <input type="file" name="product_file" class="form-control" required accept=".xlsx, .xls">
                        <button class="btn btn-success" type="submit">품목 업로드</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-md-12">
            <div class="card shadow-sm border-dark border-opacity-25">
                <div class="card-header bg-dark text-white fw-bold d-flex justify-content-between">
                    <span>3. 거래처-품목 연결 (Mapping)</span>
                    <small>Step 3</small>
                </div>
                <div class="card-body">
                    <h6 class="fw-bold text-dark mb-2">📊 엑셀 작성 양식</h6>
                    <div class="alert alert-secondary small py-2 mb-2">
                        ※ <strong>Step 1, 2</strong>에 등록된 거래처명과 SKU가 정확히 일치해야 합니다.
                    </div>
                    <table class="table table-bordered table-sm text-center small mb-3">
                        <thead class="table-light">
                            <tr>
                                <th style="width: 50%;">A열 (정확한 이름)</th>
                                <th style="width: 50%;">B열 (정확한 코드)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="fw-bold">
                                <td>거래처명</td>
                                <td>품목코드 (SKU)</td>
                            </tr>
                            <tr class="text-muted">
                                <td>(예) 김밥천국 본점</td>
                                <td>EG-30-001</td>
                            </tr>
                        </tbody>
                    </table>

                    <form method="post" enctype="multipart/form-data" class="input-group">
                        {% csrf_token %}
                        <input type="file" name="mapping_file" class="form-control" required accept=".xlsx, .xls">
                        <button class="btn btn-dark" type="submit">매핑 업로드</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <div class="text-center mt-5 mb-5 text-muted small">
        &copy; 2025 Order Management System
    </div>
</div>
{% endblock %}