{% extends 'base.html' %}

{% block title %}부자재 목록{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="m-0">부자재 목록</h2>
        <a href="{% url 'rawmaterial-create' %}" class="btn btn-primary">신규 부자재 등록</a>
    </div>

    <div class="card">
        <div class="card-body">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th style="width: 80px;">이미지</th>
                        <th>부자재명</th>
                        <th>부자재코드</th>
                        <th>바코드</th>
                        <th>단가</th>
                        <th>활성 상태</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for material in materials %}
                    <tr>
                        <td>
                            {% if material.image %}
                                <img src="{{ material.image.url }}" alt="{{ material.name }}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 8px;" onclick="showImageModal('{{ material.image.url }}')">
                            {% else %}
                                <div style="width: 50px; height: 50px; background-color: #eee; border-radius: 8px;"></div>
                            {% endif %}
                        </td>
                        <td>{{ material.name }}</td>
                        <td>{{ material.sku }}</td>
                        <td>{{ material.barcode|default:'-' }}</td>
                        <td>{{ material.unit_price|floatformat:"0" }}원</td>
                        <td>
                            {% if material.is_active %}
                                <span class="badge bg-success">활성</span>
                            {% else %}
                                <span class="badge bg-danger">비활성</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'rawmaterial-edit' material.pk %}" class="btn btn-sm btn-outline-secondary">수정</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7" class="text-center">등록된 부자재가 없습니다.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- 페이지네이션 -->
    {% if is_paginated %}
    <nav aria-label="Page navigation" class="mt-4">
        <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">이전</a></li>
            {% else %}
                <li class="page-item disabled"><a class="page-link" href="#">이전</a></li>
            {% endif %}

            {% for i in paginator.page_range %}
                {% if page_obj.number == i %}
                    <li class="page-item active" aria-current="page"><span class="page-link">{{ i }}</span></li>
                {% else %}
                    <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                {% endif %}
            {% endfor %}

            {% if page_obj.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">다음</a></li>
            {% else %}
                <li class="page-item disabled"><a class="page-link" href="#">다음</a></li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}
